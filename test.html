<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ClockWork Beta Tester Feedback">
    <meta name="theme-color" content="#f97316">
    <title>ClockWork - Beta Feedback</title>

    <link rel="icon" type="image/png" href="/forge.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        clockwork: { orange: '#f97316', dark: '#0a0a0a', darker: '#050505' }
                    }
                }
            }
        }
    </script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        html { scroll-behavior: smooth; }
        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
            -webkit-font-smoothing: antialiased;
        }
        .glass {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.08);
        }
        .glow { box-shadow: 0 0 30px rgba(249, 115, 22, 0.3); }
        .glow-text { text-shadow: 0 0 20px rgba(249, 115, 22, 0.5); }

        /* Section styling */
        .section-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        /* Mood selector */
        .mood-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.1);
            background: rgba(0,0,0,0.3);
            font-size: 24px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .mood-btn:hover {
            transform: scale(1.1);
            border-color: rgba(249, 115, 22, 0.5);
        }
        .mood-btn.selected {
            border-color: #f97316;
            background: rgba(249, 115, 22, 0.2);
            transform: scale(1.15);
            box-shadow: 0 0 20px rgba(249, 115, 22, 0.4);
        }

        /* Rating slider */
        .rating-slider {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: rgba(255,255,255,0.1);
            outline: none;
        }
        .rating-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #f97316;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(249, 115, 22, 0.5);
        }
        .rating-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #f97316;
            cursor: pointer;
            border: none;
        }

        /* Progress bar */
        .progress-bar-bg {
            background: rgba(255,255,255,0.1);
            border-radius: 9999px;
            overflow: hidden;
        }
        .progress-bar-fill {
            background: linear-gradient(90deg, #f97316, #fb923c);
            height: 100%;
            border-radius: 9999px;
            transition: width 0.5s ease-out;
        }

        /* Task checkbox */
        .task-checkbox {
            appearance: none;
            width: 24px;
            height: 24px;
            border: 2px solid rgba(249, 115, 22, 0.5);
            border-radius: 6px;
            background: rgba(0,0,0,0.3);
            cursor: pointer;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }
        .task-checkbox:checked {
            background: #f97316;
            border-color: #f97316;
        }
        .task-checkbox:checked::after {
            content: '\2713';
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
            height: 100%;
        }

        /* Textarea */
        .feedback-textarea {
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            color: white;
            padding: 12px;
            width: 100%;
            min-height: 80px;
            resize: vertical;
        }
        .feedback-textarea:focus {
            outline: none;
            border-color: #f97316;
        }
        .feedback-textarea::placeholder {
            color: rgba(255,255,255,0.3);
        }

        /* Celebration */
        @keyframes celebrate {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        @keyframes confetti {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-100px) rotate(720deg); opacity: 0; }
        }
        .celebrate { animation: celebrate 0.5s ease-in-out; }
        .confetti-piece {
            position: fixed;
            width: 10px;
            height: 10px;
            animation: confetti 1s ease-out forwards;
        }

        .error-message {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.5);
            color: #fca5a5;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
        }
    </style>
</head>
<body class="text-white">
    <div id="app" class="min-h-screen">
        <div class="flex items-center justify-center min-h-screen">
            <div class="text-center">
                <i class="fas fa-circle-notch fa-spin text-4xl text-clockwork-orange mb-4"></i>
                <p class="text-gray-400">Loading...</p>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // API CONFIGURATION
        // ============================================
        const API_URL = '/api';

        const api = {
            async fetch(endpoint, options = {}) {
                const token = localStorage.getItem('test_token');
                const response = await fetch(`${API_URL}${endpoint}`, {
                    ...options,
                    headers: {
                        'Content-Type': 'application/json',
                        ...(token && { 'Authorization': `Bearer ${token}` }),
                        ...options.headers
                    }
                });
                const data = await response.json();
                if (!response.ok) throw new Error(data.message || 'Request failed');
                return data;
            },
            get: (endpoint) => api.fetch(endpoint),
            post: (endpoint, body) => api.fetch(endpoint, { method: 'POST', body: JSON.stringify(body) })
        };

        // ============================================
        // FEEDBACK SECTIONS DATA
        // ============================================
        const feedbackSections = [
            {
                id: 'first-impressions',
                title: 'First Impressions',
                icon: 'fa-eye',
                description: 'Your initial reaction to ClockWork',
                tasks: [
                    { id: 'fi-1', text: 'Open the app and look around the dashboard' },
                    { id: 'fi-2', text: 'Check out the navigation and menu options' }
                ],
                moodQuestion: 'How did the app make you feel when you first opened it?',
                ratingQuestion: 'How intuitive was the layout?',
                feedbackPrompt: 'What was your first thought when you saw the app?'
            },
            {
                id: 'onboarding',
                title: 'Getting Set Up',
                icon: 'fa-user-plus',
                description: 'The signup and onboarding experience',
                tasks: [
                    { id: 'ob-1', text: 'Complete the onboarding questionnaire' },
                    { id: 'ob-2', text: 'Set your fitness goals and preferences' }
                ],
                moodQuestion: 'How did the onboarding process feel?',
                ratingQuestion: 'How easy was it to get started?',
                feedbackPrompt: 'Was anything confusing or missing during setup?'
            },
            {
                id: 'forge',
                title: 'FORGE - AI Program',
                icon: 'fa-hammer',
                description: 'Getting your personalized workout program',
                tasks: [
                    { id: 'fg-1', text: 'Generate your AI workout program' },
                    { id: 'fg-2', text: 'Review the workouts it created for you' },
                    { id: 'fg-3', text: 'Check if the exercises match your goals' }
                ],
                moodQuestion: 'How did you feel about your generated program?',
                ratingQuestion: 'How personalized did the program feel?',
                feedbackPrompt: 'Did the AI understand what you were looking for? What would you change?'
            },
            {
                id: 'workout',
                title: 'Working Out',
                icon: 'fa-dumbbell',
                description: 'Actually using ClockWork during a workout',
                tasks: [
                    { id: 'wo-1', text: 'Start and complete at least one workout' },
                    { id: 'wo-2', text: 'Log your sets, reps, and weights' },
                    { id: 'wo-3', text: 'Use the rest timer between sets' }
                ],
                moodQuestion: 'How was the experience of working out with ClockWork?',
                ratingQuestion: 'How easy was it to log your exercises?',
                feedbackPrompt: 'Would you actually use this during your real workouts? Why or why not?'
            },
            {
                id: 'ai-coach',
                title: 'AI Coach',
                icon: 'fa-robot',
                description: 'Chatting with your AI fitness coach',
                tasks: [
                    { id: 'ai-1', text: 'Ask the AI coach a fitness question' },
                    { id: 'ai-2', text: 'Ask for advice on form or technique' }
                ],
                moodQuestion: 'How helpful was the AI coach?',
                ratingQuestion: 'How knowledgeable did the AI seem?',
                feedbackPrompt: 'Did the AI give you useful answers? What did you ask it?'
            },
            {
                id: 'progress',
                title: 'Tracking Progress',
                icon: 'fa-chart-line',
                description: 'Seeing your stats and improvements',
                tasks: [
                    { id: 'pr-1', text: 'Log your body weight' },
                    { id: 'pr-2', text: 'View your workout history or stats' }
                ],
                moodQuestion: 'How motivating is the progress tracking?',
                ratingQuestion: 'How useful are the stats and charts?',
                feedbackPrompt: 'What other stats or tracking would you want to see?'
            },
            {
                id: 'overall',
                title: 'Overall Experience',
                icon: 'fa-star',
                description: 'Your big-picture thoughts on ClockWork',
                tasks: [
                    { id: 'ov-1', text: 'Explore any features we haven\'t mentioned' }
                ],
                moodQuestion: 'Overall, how do you feel about ClockWork?',
                ratingQuestion: 'How likely are you to recommend ClockWork to a friend?',
                feedbackPrompt: 'What\'s the ONE thing that would make you love this app?'
            },
            {
                id: 'pricing',
                title: 'Value & Pricing',
                icon: 'fa-tag',
                description: 'Is ClockWork worth it?',
                tasks: [],
                moodQuestion: 'How do you feel about paying for an app like this?',
                ratingQuestion: 'How would you rate the value for the price?',
                feedbackPrompt: 'What price feels fair? What features would make you willing to pay more?',
                extraQuestions: [
                    {
                        id: 'price-range',
                        question: 'What would you pay monthly for ClockWork?',
                        options: ['Free only', '$5-10/mo', '$10-20/mo', '$20-30/mo', '$30+/mo']
                    },
                    {
                        id: 'compare',
                        question: 'Compared to other fitness apps you\'ve tried:',
                        options: ['Much worse', 'Worse', 'About the same', 'Better', 'Much better', 'Haven\'t tried others']
                    }
                ]
            }
        ];

        // ============================================
        // STATE
        // ============================================
        let currentUser = null;

        function getStorageKey() {
            return currentUser ? `clockwork_feedback_${currentUser.id}` : null;
        }

        function getStoredData() {
            const key = getStorageKey();
            if (!key) return null;
            try {
                const data = localStorage.getItem(key);
                return data ? JSON.parse(data) : getDefaultData();
            } catch {
                return getDefaultData();
            }
        }

        function getDefaultData() {
            return {
                completedTasks: [],
                moods: {},
                ratings: {},
                feedback: {},
                extraAnswers: {},
                celebrationShown: false
            };
        }

        function saveData(data) {
            const key = getStorageKey();
            if (key) {
                localStorage.setItem(key, JSON.stringify(data));
            }
        }

        function calculateProgress(data) {
            let total = 0;
            let completed = 0;

            feedbackSections.forEach(section => {
                // Tasks
                total += section.tasks.length;
                completed += section.tasks.filter(t => data.completedTasks.includes(t.id)).length;

                // Mood (counts as 1)
                total += 1;
                if (data.moods[section.id]) completed += 1;

                // Rating (counts as 1)
                total += 1;
                if (data.ratings[section.id] !== undefined) completed += 1;

                // Extra questions
                if (section.extraQuestions) {
                    total += section.extraQuestions.length;
                    completed += section.extraQuestions.filter(q => data.extraAnswers[q.id]).length;
                }
            });

            return total > 0 ? Math.round((completed / total) * 100) : 0;
        }

        // ============================================
        // AUTH
        // ============================================
        async function checkAuth() {
            const token = localStorage.getItem('test_token');
            if (!token) {
                renderLogin();
                return;
            }
            try {
                const data = await api.get('/users/profile');
                currentUser = data.user || data.data || data;
                renderApp();
            } catch (err) {
                localStorage.removeItem('test_token');
                renderLogin();
            }
        }

        async function login(email, password) {
            const data = await api.post('/auth/login', { email, password });
            localStorage.setItem('test_token', data.token);
            currentUser = data.user;
            renderApp();
        }

        function logout() {
            localStorage.removeItem('test_token');
            currentUser = null;
            renderLogin();
        }

        // ============================================
        // RENDER
        // ============================================
        function renderLogin() {
            const app = document.getElementById('app');
            app.innerHTML = `
                <div class="min-h-screen flex items-center justify-center p-4">
                    <div class="glass rounded-2xl p-8 max-w-md w-full text-center">
                        <div class="mb-6">
                            <i class="fas fa-bolt text-5xl text-clockwork-orange glow-text mb-4"></i>
                            <h1 class="text-3xl font-bold mb-2">ClockWork</h1>
                            <p class="text-gray-400">Beta Tester Feedback</p>
                        </div>

                        <p class="text-gray-300 mb-6">
                            Sign in to share your experience and help us make ClockWork amazing.
                        </p>

                        <div id="login-error" class="hidden error-message mb-4"></div>

                        <form id="login-form" class="space-y-4">
                            <input type="email" id="email-input" placeholder="Email address"
                                class="w-full px-4 py-3 bg-black/50 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-clockwork-orange"
                                required autocomplete="email" />
                            <input type="password" id="passcode-input" placeholder="Passcode"
                                class="w-full px-4 py-3 bg-black/50 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-clockwork-orange"
                                required autocomplete="current-password" />
                            <button type="submit" id="login-btn"
                                class="w-full py-3 bg-clockwork-orange hover:bg-orange-600 text-white font-semibold rounded-xl transition-all glow">
                                Sign In <i class="fas fa-arrow-right ml-2"></i>
                            </button>
                        </form>

                        <p class="text-gray-500 text-sm mt-6">
                            Need an account? <a href="/" class="text-clockwork-orange hover:underline">Sign up at ClockWork</a>
                        </p>
                    </div>
                </div>
            `;

            document.getElementById('login-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('email-input').value.trim();
                const password = document.getElementById('passcode-input').value;
                const btn = document.getElementById('login-btn');
                const errorDiv = document.getElementById('login-error');

                btn.disabled = true;
                btn.innerHTML = '<i class="fas fa-circle-notch fa-spin mr-2"></i>Signing in...';
                errorDiv.classList.add('hidden');

                try {
                    await login(email, password);
                } catch (err) {
                    errorDiv.textContent = err.message || 'Invalid email or passcode';
                    errorDiv.classList.remove('hidden');
                    btn.disabled = false;
                    btn.innerHTML = 'Sign In <i class="fas fa-arrow-right ml-2"></i>';
                }
            });
        }

        function renderApp() {
            if (!currentUser) return renderLogin();

            const data = getStoredData();
            const progress = calculateProgress(data);
            const displayName = currentUser.name || currentUser.email.split('@')[0];
            const isComplete = progress === 100;

            const app = document.getElementById('app');
            app.innerHTML = `
                <div class="max-w-2xl mx-auto p-4 pb-24">
                    <!-- Header -->
                    <div class="glass rounded-2xl p-6 mb-6">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <h1 class="text-2xl font-bold">
                                    <i class="fas fa-bolt text-clockwork-orange mr-2"></i>Beta Feedback
                                </h1>
                                <p class="text-gray-400">Thanks for testing, ${escapeHtml(displayName)}!</p>
                            </div>
                            <button onclick="logout()" class="text-gray-500 hover:text-red-400 transition-colors" title="Sign Out">
                                <i class="fas fa-sign-out-alt"></i>
                            </button>
                        </div>

                        <div class="mb-2">
                            <div class="flex justify-between text-sm mb-1">
                                <span class="text-gray-400">Feedback Progress</span>
                                <span class="text-clockwork-orange font-semibold">${progress}%</span>
                            </div>
                            <div class="progress-bar-bg h-3">
                                <div class="progress-bar-fill" style="width: ${progress}%"></div>
                            </div>
                        </div>
                        <p class="text-sm text-gray-500">Your feedback helps us build a better app</p>
                    </div>

                    ${isComplete ? renderCompletion(displayName) : ''}

                    <!-- Sections -->
                    <div class="space-y-6">
                        ${feedbackSections.map(section => renderSection(section, data)).join('')}
                    </div>

                    <!-- Final thoughts -->
                    <div class="section-card p-6 mt-6">
                        <h2 class="text-xl font-bold mb-4">
                            <i class="fas fa-comment-dots text-clockwork-orange mr-2"></i>
                            Anything else?
                        </h2>
                        <textarea
                            class="feedback-textarea"
                            placeholder="Any bugs, ideas, complaints, or compliments? We want to hear it all..."
                            data-field="final-thoughts"
                            onchange="saveFeedback('final-thoughts', this.value)"
                        >${escapeHtml(data.feedback['final-thoughts'] || '')}</textarea>
                    </div>
                </div>
            `;

            if (isComplete && !data.celebrationShown) {
                data.celebrationShown = true;
                saveData(data);
                triggerConfetti();
            }
        }

        function renderSection(section, data) {
            const sectionMood = data.moods[section.id];
            const sectionRating = data.ratings[section.id];

            return `
                <div class="section-card p-6">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-12 h-12 rounded-xl bg-clockwork-orange/20 flex items-center justify-center">
                            <i class="fas ${section.icon} text-clockwork-orange text-xl"></i>
                        </div>
                        <div>
                            <h2 class="text-lg font-bold">${section.title}</h2>
                            <p class="text-sm text-gray-500">${section.description}</p>
                        </div>
                    </div>

                    ${section.tasks.length > 0 ? `
                        <div class="mb-5">
                            <p class="text-sm text-gray-400 mb-2">Try these:</p>
                            <div class="space-y-2">
                                ${section.tasks.map(task => `
                                    <label class="flex items-center gap-3 p-2 rounded-lg hover:bg-white/5 cursor-pointer">
                                        <input type="checkbox" class="task-checkbox" data-task="${task.id}"
                                            ${data.completedTasks.includes(task.id) ? 'checked' : ''}
                                            onchange="toggleTask('${task.id}', this.checked)" />
                                        <span class="text-sm text-gray-300 ${data.completedTasks.includes(task.id) ? 'line-through opacity-60' : ''}">${task.text}</span>
                                    </label>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}

                    <!-- Mood -->
                    <div class="mb-5">
                        <p class="text-sm text-gray-300 mb-3">${section.moodQuestion}</p>
                        <div class="flex justify-between gap-2">
                            ${['ðŸ˜«', 'ðŸ˜•', 'ðŸ˜', 'ðŸ™‚', 'ðŸ˜'].map((emoji, i) => `
                                <button class="mood-btn ${sectionMood === i + 1 ? 'selected' : ''}"
                                    onclick="setMood('${section.id}', ${i + 1})">
                                    ${emoji}
                                </button>
                            `).join('')}
                        </div>
                        <div class="flex justify-between text-xs text-gray-500 mt-1 px-2">
                            <span>Frustrated</span>
                            <span>Loved it</span>
                        </div>
                    </div>

                    <!-- Rating slider -->
                    <div class="mb-5">
                        <div class="flex justify-between text-sm mb-2">
                            <span class="text-gray-300">${section.ratingQuestion}</span>
                            <span class="text-clockwork-orange font-semibold">${sectionRating !== undefined ? sectionRating + '/10' : 'â€”'}</span>
                        </div>
                        <input type="range" min="1" max="10" value="${sectionRating || 5}" class="rating-slider"
                            oninput="setRating('${section.id}', this.value)" />
                        <div class="flex justify-between text-xs text-gray-500 mt-1">
                            <span>Poor</span>
                            <span>Amazing</span>
                        </div>
                    </div>

                    ${section.extraQuestions ? section.extraQuestions.map(q => `
                        <div class="mb-5">
                            <p class="text-sm text-gray-300 mb-2">${q.question}</p>
                            <div class="flex flex-wrap gap-2">
                                ${q.options.map(opt => `
                                    <button class="px-3 py-2 text-sm rounded-lg border transition-all
                                        ${data.extraAnswers[q.id] === opt
                                            ? 'border-clockwork-orange bg-clockwork-orange/20 text-white'
                                            : 'border-white/10 bg-black/30 text-gray-400 hover:border-white/30'}"
                                        onclick="setExtraAnswer('${q.id}', '${opt}')">
                                        ${opt}
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    `).join('') : ''}

                    <!-- Open feedback -->
                    <div>
                        <p class="text-sm text-gray-400 mb-2">${section.feedbackPrompt}</p>
                        <textarea
                            class="feedback-textarea text-sm"
                            placeholder="Type your thoughts..."
                            data-section="${section.id}"
                            onchange="saveFeedback('${section.id}', this.value)"
                        >${escapeHtml(data.feedback[section.id] || '')}</textarea>
                    </div>
                </div>
            `;
        }

        function renderCompletion(name) {
            return `
                <div class="glass rounded-2xl p-6 mb-6 text-center border-2 border-green-500 celebrate" style="box-shadow: 0 0 30px rgba(34, 197, 94, 0.3);">
                    <div class="text-5xl mb-4">ðŸŽ‰</div>
                    <h2 class="text-2xl font-bold text-green-400 mb-2">
                        You're amazing, ${escapeHtml(name)}!
                    </h2>
                    <p class="text-gray-300">
                        Thank you for your detailed feedback. You're helping shape the future of ClockWork!
                    </p>
                </div>
            `;
        }

        // ============================================
        // ACTIONS
        // ============================================
        function toggleTask(taskId, checked) {
            const data = getStoredData();
            if (checked && !data.completedTasks.includes(taskId)) {
                data.completedTasks.push(taskId);
            } else if (!checked) {
                data.completedTasks = data.completedTasks.filter(id => id !== taskId);
            }
            saveData(data);
            renderApp();
        }

        function setMood(sectionId, value) {
            const data = getStoredData();
            data.moods[sectionId] = value;
            saveData(data);
            renderApp();
        }

        function setRating(sectionId, value) {
            const data = getStoredData();
            data.ratings[sectionId] = parseInt(value);
            saveData(data);
            // Don't re-render to avoid slider jumping, just save
            const progress = calculateProgress(data);
            document.querySelector('.progress-bar-fill').style.width = progress + '%';
            document.querySelector('.text-clockwork-orange.font-semibold').textContent = progress + '%';
        }

        function setExtraAnswer(questionId, value) {
            const data = getStoredData();
            data.extraAnswers[questionId] = value;
            saveData(data);
            renderApp();
        }

        function saveFeedback(sectionId, value) {
            const data = getStoredData();
            data.feedback[sectionId] = value;
            saveData(data);
        }

        function triggerConfetti() {
            const colors = ['#f97316', '#fb923c', '#fbbf24', '#34d399', '#60a5fa', '#a78bfa'];
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti-piece';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.top = '100vh';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                confetti.style.animationDelay = Math.random() * 0.5 + 's';
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 1500);
            }
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Init
        document.addEventListener('DOMContentLoaded', checkAuth);
    </script>
</body>
</html>
